# 第 4 章 gcc, C语言编译器

* `Mon Jul  5 21:13:58 CST 2021`

### 4.1 什么是交叉编译器

* 如果在编译 gcc 时，指定主机处理器型号和目标机处理器型号不一致，则所生成的编译器就是交叉编译器


### 4.2 gcc幕后工作揭示

* 预处理(preprocessing)、编译(compilation)、汇编(assembly)、链接(linking)
* `ccp`(C Preprocessor): 预处理的目的就是展开源文件中的所有宏指令 
* `cc`(C and C++ compiler) 编译的结果是生成汇编程序
* `as`(assembler) 转换成目标文件
* `ld` 生成一个可以运行的可执行程序
* as 和 ld 工具都来自于 binutils 工具集


### 4.3 实用的 gcc 选项

**4.3.1 解决宏错误的好帮手**

* 通过使用 `-E` 选项，可以获得 gcc 对 .c 文件完成预处理后的结果
* `# 行号  文件名 标志`

**4.3.2 辅助编写汇编程序的友好方法**

* 通过使用 gcc 的 `-S` 参数能获得一个C源程序的汇编程序
* 可以根据需要时用 `-O` 优化选项

**4.3.3 获取系统头文件路径**

*  通过使用 gcc 的 `-v` 选项就可以获取系统头文件路径

**4.3.4 产生映射文件**

* `nm` 工具了解一个程序文件中各符号在内存中的布局信息

```shell
gcc --help|grep Wl
ld --help|grep Map
gcc -Wl,-Map=main.map main.c -o main
```

**4.3.5 通过选项定义宏**

* `gcc -D 'GREETING="hello"`

**4.3.6 生成依赖关系**

* `-M`选项，可以获得文件的依赖关系
* `-MM`选项，可以生成不博阿含系统头文件的依赖关系 


**4.3.7 指定链接库**

* `-L` 可以从那个目录查找库文件
8 `-i` 需要链接的库名
